~~~~ AGGREGATES
SELECT 
        SUM(TRANSACTION_QTY*UNIT_PRICE) AS total_revenue,
        SUM(TRANSACTION_QTY) AS number_of_units_sold,       
        COUNT(TRANSACTION_ID) AS number_of_sales,
        TO_CHAR(TRANSACTION_DATE, 'YYYYMM') AS month_id,
        MONTHNAME(TRANSACTION_DATE) AS MONTH_NAME,
        DAYNAME(TRANSACTION_DATE) AS DAY_NAME,
        PRODUCT_CATEGORY,
        PRODUCT_TYPE,
        STORE_LOCATION,
        PRODUCT_DETAIL,

~~~~ GROUPINGS

        CASE
            WHEN TRANSACTION_TIME BETWEEN '06:00:00' AND '11:59:59' THEN 'Morning'
            WHEN TRANSACTION_TIME BETWEEN '12:00:00' AND '15:59:59' THEN 'Afternoon'
            WHEN TRANSACTION_TIME BETWEEN '16:00:00' AND '20:59:59' THEN 'Evening'
            ELSE 'Night'
            END AS TIME_BUCKET, 
        CASE 
            WHEN SUM(TRANSACTION_QTY*UNIT_PRICE) BETWEEN 0 AND 20 THEN 'Low'
            WHEN SUM(TRANSACTION_QTY*UNIT_PRICE) BETWEEN 21 AND 40 THEN 'Medium'
            WHEN SUM(TRANSACTION_QTY*UNIT_PRICE) BETWEEN 41 AND 60 THEN 'High'
            ELSE 'Very high'
            END AS SPEND_BANDS,       
    FROM BRIGHT_COFFEE_SHOP.COFFEE_SHOP.COFFEE_SHOP_TRANSACTIONS
    GROUP BY TIME_BUCKET,
             PRODUCT_CATEGORY,
             PRODUCT_TYPE,
             STORE_LOCATION,
             PRODUCT_DETAIL,
             MONTH_ID,
             MONTH_NAME,
             DAY_NAME;
